/*
 * iosSlider - http://iosscripts.com/iosslider-jquery-horizontal-slider-for-iphone-ipad-safari/
 * 
 * A jQuery Horizontal Slider for iPhone/iPad Safari (Beta) 
 * This plugin turns any wide element into a touch enabled horizontal slider.
 * 
 * Copyright (c) 2012 Marc Whitbread
 * 
 * Version: v0.9.4 beta (05/16/2012)
 * Requires: jQuery v1.3+
 *
 * My Rules:
 *
 * 1) You may use iosSlider freely, without restriction in any material intended for sale 
 *    or distribution. Attribution is not required but always appreciated.
 * 2) You are not permitted to make the resources found on iosscripts.com available for 
 *    distribution elsewhere "as is" without prior consent. If you would like to feature 
 *    iosSlider on your site, please do not link directly to the resource zip files. Please 
 *    link to the appropriate page on iosscripts.com where users can find the download.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY 
 * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
 * COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE
 * GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED 
 * AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED 
 * OF THE POSSIBILITY OF SUCH DAMAGE. 
 */
 
(function(a){var L=0,F=0,M=0,D=0,A="ontouchstart"in window,G=!1,X=!1,Y=!1,N="pointer",Q="pointer",R=[],K=[],S=[],T=[],O=[],l=[],f={showScrollbar:function(j,b){j.scrollbarHide&&a("."+b).css({opacity:j.scrollbarOpacity,filter:"alpha(opacity:"+100*j.scrollbarOpacity+")"})},hideScrollbar:function(a,b,d,c,e,g,C,o,m,h){if(a.scrollbar&&a.scrollbarHide)for(var i=d;i<d+25;i++)b[b.length]=f.hideScrollbarIntervalTimer(10*i,c[d],(d+24-i)/24,e,g,C,o,m,h,a)},hideScrollbarInterval:function(j,b,d,c,e,g,C,o,m){D= -1*j/d*(g-C-o-e);f.setSliderOffset("."+c,D);a("."+c).css({opacity:m.scrollbarOpacity*b,filter:"alpha(opacity:"+100*m.scrollbarOpacity*b+")"})},slowScrollHorizontalInterval:function(j,b,d,c,e,g,C,o,m,h,i,l,w,p){newChildOffset=f.calcActiveOffset(p,b,0,h,d,g,l,void 0);if(newChildOffset!=m)p.onSlideChange(new f.args(p,j,a(j).children(":eq("+m+")"),m%l));b=Math.floor(b);f.setSliderOffset(j,b);p.scrollbar&&(D=Math.floor(-1*b/d*(g-C-e)),j=e-o,0<=b?(j=e-o- -1*D,f.setSliderOffset(a("."+c),0)):(b<=-1*d+1&& (j=g-C-o-D),f.setSliderOffset(a("."+c),D)),a("."+c).css({width:j+"px"}))},slowScrollHorizontal:function(j,b,d,c,e,g,C,o,m,h,i,y,w,p,k,v){var g=[],q=f.getSliderOffset(j,"x"),t=0,r=25/1024*o;frictionCoefficient=v.frictionCoefficient;elasticFrictionCoefficient=v.elasticFrictionCoefficient;snapFrictionCoefficient=v.snapFrictionCoefficient;snapToChildren=v.snapToChildren;5<e&&snapToChildren?t=1:-5>e&&snapToChildren&&(t=-1);e<-1*r?e=-1*r:e>r&&(e=r);var u=f.getAnimationSteps(v,e,q,d,0,i),r=f.calcActiveOffset(v, u[u.length-1],t,i,d,o,w,l[y]);v.infiniteSlider&&(i[r]>i[k+1]+o&&(r+=k),i[r]<i[2*k-1]-o&&(r-=k));if(u[u.length-1]<i[r]&&0>t||u[u.length-1]>i[r]&&0<t||!snapToChildren)for(;1<e||-1>e;){e*=frictionCoefficient;q+=e;if(0<q||q<-1*d)e*=elasticFrictionCoefficient,q+=e;g[g.length]=q}if(snapToChildren||0<q||q<-1*d){for(;q<i[r]-0.5||q>i[r]+0.5;)q=(q-i[r])*snapFrictionCoefficient+i[r],g[g.length]=q;g[g.length]=i[r]}e=1;for(0!=g.length%2&&(e=0);e<g.length;e+=2)b[b.length]=f.slowScrollHorizontalIntervalTimer(10* e,j,g[e],d,c,C,o,m,h,r,i,p,w,k,v);b[b.length]=f.onSlideCompleteTimer(10*(e+1),v,j,a(j).children(":eq("+r+")"),r%w,y);O[y]=b;f.hideScrollbar(v,b,e,g,d,c,C,o,m,h);l[y]=r},onSlideComplete:function(a,b,d,c,e){if(R[e]!=c)a.onSlideComplete(new f.args(a,b,d,c));R[e]=c},getSliderOffset:function(j,b){var d=0,b="x"==b?4:5;A||G?(d=a(j).css("-webkit-transform").split(","),d=parseInt(d[b],10)):d=parseInt(a(j).css("left"),10);return d},setSliderOffset:function(j,b){A||G?a(j).css({webkitTransform:"translateX("+ b+"px)"}):a(j).css({left:b+"px"})},setBrowserInfo:function(){null!=navigator.userAgent.match("WebKit")?(G=!0,N="-webkit-grab",Q="-webkit-grabbing"):null!=navigator.userAgent.match("Gecko")?(N="move",Q="-moz-grabbing"):null!=navigator.userAgent.match("MSIE 7")?X=!0:null!=navigator.userAgent.match("MSIE 8")?Y=!0:navigator.userAgent.match("MSIE 9")},getAnimationSteps:function(a,b,d,c,e){var g=[];for(1>=b&&0<=b?b=-2:-1<=b&&0>=b&&(b=2);1<b||-1>b;){b*=a.frictionCoefficient;d+=b;if(d>e||d<-1*c)b*=a.elasticFrictionCoefficient, d+=b;g[g.length]=d}activeChildOffset=0;return g},calcActiveOffset:function(a,b,d,c,e,g,f,o){for(var m=!1,a=[],h,e=0;e<c.length;e++)c[e]<=b&&c[e]>b-g&&(!m&&c[e]!=b&&(a[a.length]=c[e-1]),a[a.length]=c[e],m=!0);0==a.length&&(a[0]=c[c.length-1]);for(e=m=0;e<a.length;e++){var i=Math.abs(b-a[e]);i<g&&(m=a[e],g=i)}for(e=0;e<c.length;e++)m==c[e]&&(h=e);0>d&&h%f==o%f?(h=o+1,h>=c.length&&(h=c.length-1)):0<d&&h%f==o%f&&(h=o-1,0>h&&(h=0));return h},changeSlide:function(j,b,d,c,e,g,l,o,m,h,i,y,w,p,k){f.autoSlidePause(i); for(var v=0;v<d.length;v++)clearTimeout(d[v]);var v=Math.ceil(k.autoSlideTransTimer/10)+1,q=f.getSliderOffset(b,"x"),t=h[j]-q,r=[],u;f.showScrollbar(k,e);for(var n=0;n<=v;n++){u=n;u/=v;u--;u=q+t*(Math.pow(u,5)+1);if(k.infiniteSlider&&(u>h[p+1]+l&&(u-=w,j=2*p-1),u<h[2*p-1]-l))u+=w,j=p+1;r[r.length]=u}for(n=0;n<r.length;n++)d[n]=f.slowScrollHorizontalIntervalTimer(10*(n+1),b,r[n],c,e,g,l,o,m,j,h,w,y,p,k);0!=t&&(d[d.length]=f.onSlideCompleteTimer(10*(n+1),k,b,a(b).children(":eq("+j+")"),j%y,i));O[i]= d;f.hideScrollbar(k,d,n,r,c,e,g,l,o,m);f.autoSlide(b,d,c,e,g,l,o,m,h,i,y,w,p,k);return j},autoSlide:function(a,b,d,c,e,g,C,o,m,h,i,y,w,p){if(!p.autoSlide)return!1;f.autoSlidePause(h);K[h]=setTimeout(function(){!p.infiniteSlider&&l[h]>m.length-1&&(l[h]-=w);l[h]=f.changeSlide(l[h]+1,a,b,d,c,e,g,C,o,m,h,i,y,w,p);f.autoSlide(a,b,d,c,e,g,C,o,m,h,i,y,w,p)},p.autoSlideTimer+p.autoSlideTransTimer)},autoSlidePause:function(a){clearTimeout(K[a])},slowScrollHorizontalIntervalTimer:function(a,b,d,c,e,g,l,o,m, h,i,y,w,p,k){return setTimeout(function(){f.slowScrollHorizontalInterval(b,d,c,e,g,l,o,m,h,i,y,w,p,k)},a)},onSlideCompleteTimer:function(a,b,d,c,e,g){return setTimeout(function(){f.onSlideComplete(b,d,c,e,g)},a)},hideScrollbarIntervalTimer:function(a,b,d,c,e,g,l,o,m,h){return setTimeout(function(){f.hideScrollbarInterval(b,d,c,e,g,l,o,m,h)},a)},args:function(a,b,f,c){this.settings=a;this.sliderObject=b;this.currentSlideObject=f;this.currentSlideNumber=c},preventDrag:function(a){a.preventDefault()}, preventClick:function(){return!1},enableClick:function(){return!0}};f.setBrowserInfo();var J={init:function(j){var b=a.extend({elasticPullResistance:0.6,frictionCoefficient:0.92,elasticFrictionCoefficient:0.6,snapFrictionCoefficient:0.92,snapToChildren:!1,startAtSlide:1,scrollbar:!1,scrollbarHide:!0,scrollbarLocation:"top",scrollbarOpacity:0.4,scrollbarHeight:"4px",scrollbarBorder:"0",scrollbarMargin:"5px",scrollbarBackground:"#000",scrollbarBorderRadius:"100px",scrollbarShadow:"0 0 0 #000",desktopClickDrag:!1, responsiveSlideWidth:!0,navSlideSelector:"",navPrevSelector:"",navNextSelector:"",autoSlideToggleSelector:"",autoSlide:!1,autoSlideTimer:5E3,autoSlideTransTimer:750,infiniteSlider:!1,onSliderLoaded:function(){},onSlideChange:function(){},onSlideComplete:function(){}},j);return this.each(function(){function d(){f.autoSlidePause(c);a(p).css("width","");a(p).css("height","");a(U).css("width","");g=0;n=[];y=a(p).parent().width();w=a(p).parent().height();k=a(p).outerWidth(!0);v=a(p).height();b.responsiveSlideWidth&& (k=a(p).outerWidth(!0)>y?y:a(p).outerWidth(!0),v=a(p).height()>w?w:a(p).height());a(p).css({position:"relative",top:"0",left:"0",overflow:"hidden",zIndex:1,width:k,height:v});b.responsiveSlideWidth&&a(U).each(function(){var b=a(this).outerWidth(true),b=b>k?k+(a(this).outerWidth(true)-a(this).width())*-1:a(this).width();a(this).css({width:b})});a(s).children().each(function(b){a(this).css({"float":"left"});n[b]=g*-1;g=g+a(this).outerWidth(true)});for(var d=0;d<n.length&&!(n[d]<=-1*(g-k));d++)K=d;n.splice(K+ 1,n.length);n[n.length]=-1*(g-k);g-=k;a(s).css({webkitPerspective:1E3,webkitBackfaceVisibility:"hidden",position:"relative",cursor:N,width:g+k+"px",overflow:"hidden"});f.setSliderOffset(s,n[l[c]]);if(0>=g)return a(s).css({cursor:"default"}),!1;!A&&!b.desktopClickDrag&&a(s).css({cursor:"default"});b.scrollbar&&(a("."+m).css({margin:b.scrollbarMargin,overflow:"hidden",display:"none"}),a("."+m+" ."+h).css({border:b.scrollbarBorder}),q=parseInt(a("."+m).css("marginLeft"))+parseInt(a("."+m).css("marginRight")), t=parseInt(a("."+m+" ."+h).css("borderLeftWidth"),10)+parseInt(a("."+m+" ."+h).css("borderRightWidth"),10),i=Math.floor(k/(g+k)*(k-q)),b.scrollbarHide||(G=b.scrollbarOpacity),a("."+m).css({position:"absolute",left:0,width:k-q+"px",margin:b.scrollbarMargin}),"top"==b.scrollbarLocation?a("."+m).css("top","0"):a("."+m).css("bottom","0"),a("."+m+" ."+h).css({borderRadius:b.scrollbarBorderRadius,background:b.scrollbarBackground,height:b.scrollbarHeight,width:i-t+"px",minWidth:b.scrollbarHeight,border:b.scrollbarBorder, webkitPerspective:1E3,webkitBackfaceVisibility:"hidden",webkitTransform:"translateX("+Math.floor(-1*n[l[c]]/g*(k-q-i))+"px)",opacity:G,filter:"alpha(opacity:"+100*G+")",boxShadow:b.scrollbarShadow}),a("."+m).css({display:"block"}),A||a("."+h).css({position:"relative",left:Math.floor(-1*n[l[c]]/g*(k-q-i))}));b.infiniteSlider&&(B=(g+k)/3);""!=b.navSlideSelector&&a(b.navSlideSelector).each(function(d){a(this).css({cursor:"pointer"});a(this).unbind("click.iosSliderEvent").bind("click.iosSliderEvent", function(){var a=d;b.infiniteSlider&&(a=d+x);l[c]=f.changeSlide(a,s,e,g,h,i,k,q,t,n,c,x,B,z,b)})});""!=b.navPrevSelector&&(a(b.navPrevSelector).css({cursor:"pointer"}),a(b.navPrevSelector).unbind("click.iosSliderEvent").bind("click.iosSliderEvent",function(){if(l[c]>0||b.infiniteSlider)l[c]=f.changeSlide(l[c]-1,s,e,g,h,i,k,q,t,n,c,x,B,z,b)}));""!=b.navNextSelector&&(a(b.navNextSelector).css({cursor:"pointer"}),a(b.navNextSelector).unbind("click.iosSliderEvent").bind("click.iosSliderEvent",function(){if(l[c]< n.length-1||b.infiniteSlider)l[c]=f.changeSlide(l[c]+1,s,e,g,h,i,k,q,t,n,c,x,B,z,b)}));b.autoSlide&&((""!=b.autoSlideToggleSelector&&(a(b.autoSlideToggleSelector).css({cursor:"pointer"}),a(b.autoSlideToggleSelector).unbind("click.iosSliderEvent").bind("click.iosSliderEvent",function(){if(H){f.autoSlide(s,e,g,h,i,k,q,t,n,c,x,B,z,b);H=false;a(b.autoSlideToggleSelector).removeClass("on")}else{f.autoSlidePause(c);H=true;a(b.autoSlideToggleSelector).addClass("on")}})),H||f.autoSlide(s,e,g,h,i,k,q,t,n, c,x,B,z,b),A)?a(p).bind("touchend.iosSliderEvent",function(){H||f.autoSlide(s,e,g,h,i,k,q,t,n,c,x,B,z,b)}):(a(p).bind("mouseenter.iosSliderEvent",function(){f.autoSlidePause(c)}),a(p).bind("mouseleave.iosSliderEvent",function(){H||f.autoSlide(s,e,g,h,i,k,q,t,n,c,x,B,z,b)})));f.onSlideComplete(b,s,a(s).children(":eq("+l[c]+")"),l[c]%x,c);a(p).data("iosslider",{obj:Z,settings:b,scrollerNode:s,numberOfSlides:z,sliderNumber:c,childrenOffsets:n,sliderMax:g,scrollbarClass:h,scrollbarWidth:i,stageWidth:k, scrollMargin:q,scrollBorder:t,infiniteSliderOffset:x,infiniteSliderWidth:B});return!0}L++;var c=L,e=[];S[c]=b;var g,j=[0,0],o=[0,0],m="scrollbarBlock"+L,h="scrollbar"+L,i,y,w,p=a(this),k,v,q,t,r;l[c]=b.startAtSlide-1;var u=-1,n,G=0,E=0,J=0,s=a(this).children(":first-child"),U,z=a(s).children().size(),I=!1,K=0,V=!1,P=void 0,B,x=z;R[c]=-1;var H=!1;T[c]=!1;var W=-1;O[c]=[];var Z=a(this);if(void 0!=Z.data("iosslider"))return!0;b.infiniteSlider&&(b.scrollbar=!1,a(s).children().clone(!0).prependTo(s).clone(!0).appendTo(s), x=z);U=a(s).children();b.scrollbar&&a(s).parent().append("<div class = '"+m+"'><div class = '"+h+"'></div></div>");if(!d())return!0;b.infiniteSlider&&(l[c]+=x,f.setSliderOffset(s,n[l[c]]));a(this).find("a").bind("mousedown",f.preventDrag);a(this).find("[onclick]").bind("click",f.preventDrag).each(function(){a(this).data("onclick",this.onclick)});b.onSliderLoaded(new f.args(b,s,a(s).children(":eq("+l[c]+")"),l[c]%x));A&&S[c].responsiveSlideWidth?a(window).bind("orientationchange.iosSliderEvent",function(){if(!d())return true}): S[c].responsiveSlideWidth&&a(window).bind("resize.iosSliderEvent",function(){if(!d())return true});if(A||b.desktopClickDrag)if(a(s).bind("touchstart.iosSliderEvent mousedown.iosSliderEvent",function(d){f.autoSlidePause(c);if(A){eventX=event.touches[0].pageX;eventY=event.touches[0].pageY}else{window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty();eventX= d.pageX;eventY=d.pageY;V=true;P=this;a(this).css({cursor:Q})}j=[0,0];o=[0,0];F=0;I=false;for(d=0;d<e.length;d++)clearTimeout(e[d]);d=f.getSliderOffset(this,"x");W=l[c];if(b.infiniteSlider&&l[c]%z==0){var m=a(this).children(":eq("+l[c]+")").clone(this);a(this).children().each(function(b){b+1%z==0&&a(m).replaceWith(a(this))})}if(d>0){f.setSliderOffset(this,0);a("."+h).css({width:i-t+"px"})}else if(d<g*-1){d=g*-1;f.setSliderOffset(this,d);f.setSliderOffset(a("."+h),k-q-i);a("."+h).css({width:i-t+"px"})}E= (f.getSliderOffset(this,"x")-eventX)*-1;f.getSliderOffset(this,"y");j[1]=eventX;o[1]=eventY}),a(s).bind("touchmove.iosSliderEvent mousemove.iosSliderEvent",function(c){A||(window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty());if(A){eventX=event.touches[0].pageX;eventY=event.touches[0].pageY}else{eventX=c.pageX;eventY=c.pageY;if(!V)return false}if(b.infiniteSlider){f.getSliderOffset(this, "x")>n[z+1]+k&&(E=E+B);f.getSliderOffset(this,"x")<n[z*2-1]-k&&(E=E-B)}j[0]=j[1];j[1]=eventX;F=(j[1]-j[0])/2;o[0]=o[1];o[1]=eventY;M=(o[1]-o[0])/2;if((F>5||F<-5)&&A){event.preventDefault();I=true}else A||(I=true);if(I){c=f.getSliderOffset(this,"x");if(A){J!=event.touches.length&&(E=c*-1+eventX);J=event.touches.length}var d=0;elasticPullResistance=b.elasticPullResistance;c>0&&(d=(E-eventX)*elasticPullResistance);c<g*-1&&(d=(g+(E-eventX)*-1)*elasticPullResistance*-1);f.setSliderOffset(this,(E-eventX- d)*-1);if(b.scrollbar){f.showScrollbar(b,h);D=Math.floor((E-eventX-d)/g*(k-q-i));var e=i;if(c>=0){e=i-t-D*-1;f.setSliderOffset(a("."+h),0);a("."+h).css({width:e+"px"})}else if(c<=g*-1+1){e=k-q-t-D;f.setSliderOffset(a("."+h),D);a("."+h).css({width:e+"px"})}else f.setSliderOffset(a("."+h),D)}if(A)r=event.touches[0].pageX}u=f.calcActiveOffset(b,(E-eventX-d)*-1,0,n,g,k,x,void 0);if(u!=W){W=u;b.onSlideChange(new f.args(b,this,a(this).children(":eq("+u+")"),u%x))}}),a(s).bind("touchend.iosSliderEvent", function(){if(event.touches.length!=0)for(var a=0;a<sizeof(event.touches.length);a++)event.touches[a].pageX==r&&f.slowScrollHorizontal(this,e,g,h,F,M,i,k,q,t,n,c,x,B,z,b);else f.slowScrollHorizontal(this,e,g,h,F,M,i,k,q,t,n,c,x,B,z,b)}),!A){var $=a(window);if(Y||X)$=a(document);a($).bind("mouseup.iosSliderEvent",function(){I?a(s).children(":eq("+l[c]+")").find("a").unbind("click.disableClick").bind("click.disableClick",f.preventClick):a(s).children(":eq("+l[c]+")").find("a").unbind("click.disableClick").bind("click.disableClick", f.enableClick);a(s).children(":eq("+l[c]+")").find("[onclick]").each(function(){this.onclick=function(b){if(I)return false;a(this).data("onclick").call(this,b||window.event)}});if(!T[c]){a(s).css({cursor:N});V=false;if(P==void 0||j[0]==0)return false;f.slowScrollHorizontal(P,e,g,h,F,M,i,k,q,t,n,c,x,B,z,b);P=void 0}})}})},destroy:function(j){return this.each(function(){var b=a(this),d=b.data("iosslider");if(void 0==d)return!1;void 0==j&&(j=!0);f.autoSlidePause(d.sliderNumber);T[d.sliderNumber]=!0; a(window).unbind(".iosSliderEvent");a(this).unbind(".iosSliderEvent");a(this).children(":first-child").unbind(".iosSliderEvent");a(this).children(":first-child").children().unbind(".iosSliderEvent");j&&(a(this).attr("style",""),a(this).children(":first-child").attr("style",""),a(this).children(":first-child").children().attr("style",""),a(d.settings.navSlideSelector).attr("style",""),a(d.settings.navPrevSelector).attr("style",""),a(d.settings.navNextSelector).attr("style",""),a(d.settings.autoSlideToggleSelector).attr("style", ""));d.settings.infiniteSlider&&(a(this).children(":first-child").html(),a(this).children(":first-child").html(a(this).children(":first-child").children(":nth-child(-n+"+d.numberOfSlides+")").clone(!0)));b.removeData("iosslider")})},goToSlide:function(j){return this.each(function(){var b=a(this).data("iosslider");if(void 0==b)return!1;j=(j-1)%b.numberOfSlides;b.settings.infiniteSlider&&(j+=b.infiniteSliderOffset);f.changeSlide(j,a(b.scrollerNode),O[b.sliderNumber],b.sliderMax,b.scrollbarClass,b.scrollbarWidth, b.stageWidth,b.scrollMargin,b.scrollBorder,b.childrenOffsets,b.sliderNumber,b.infiniteSliderOffset,b.infiniteSliderWidth,b.numberOfSlides,b.settings);l[b.sliderNumber]=j})}};a.fn.iosSlider=function(f){if(J[f])return J[f].apply(this,Array.prototype.slice.call(arguments,1));if("object"===typeof f||!f)return J.init.apply(this,arguments);a.error("invalid method call!")}})(jQuery);